@use "./base.scss";

// 增强正文阅读体验
article {

    // 优化正文段落和列表
    p,
    ul>li,
    ol>li {
        line-height: 1.8; // 保持行高
        letter-spacing: 0.01em; // 优化字间距
        text-align: justify; // 两端对齐
        margin-bottom: 1.2em; // 段落间距
        font-weight: 400;
    }

    // 优化强调文字
    strong {
        font-weight: 600;
        color: var(--secondary);
    }

    // 优化链接样式
    a {
        text-decoration-thickness: 1px;
        text-underline-offset: 4px;
        transition: all 0.2s ease;

        &:hover {
            background-color: var(--highlight);
            border-radius: 4px;
        }
    }
}

// 针对首页文件列表的优化
.section-li>.section {
    font-family: var(--headerFont);
}

// ==========================================
// 卡片化设计 + 悬停效果
// ==========================================

// 文章列表卡片
.popover-hint,
article .page-listing,
.section-li {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);

    a {
        display: block;
        padding: 1rem 1.25rem;
        border-radius: 12px;
        background-color: var(--light);
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.06),
            0 1px 2px rgba(0, 0, 0, 0.04);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        border: 1px solid var(--lightgray);

        &:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.1),
                0 6px 12px rgba(0, 0, 0, 0.08);
            border-color: var(--secondary);
            background-color: var(--light);
        }
    }
}

// 页面内容区域卡片化
.page {
    article {
        background-color: var(--light);
        border-radius: 16px;
        padding: 2rem;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
        margin-bottom: 2rem;
        border: 1px solid var(--lightgray);
        transition: box-shadow 0.3s ease;
    }
}

// 侧边栏卡片
.left,
.right {
    .desktop-only {
        background-color: var(--light);
        border-radius: 12px;
        padding: 1rem;
        margin-bottom: 1rem;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.06);
        border: 1px solid var(--lightgray);
        transition: all 0.3s ease;

        &:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
    }
}

// Explorer 文件列表优化
#explorer-content {

    .folder-outer,
    .file-outer {
        transition: all 0.2s ease;
        border-radius: 6px;
        padding: 0.4rem 0.6rem;
        margin: 0.2rem 0;

        &:hover {
            background-color: var(--highlight);
            transform: translateX(4px);
        }
    }
}

// 搜索结果卡片
#search-container {
    .result-card {
        background-color: var(--light);
        border-radius: 10px;
        padding: 1rem;
        margin-bottom: 0.8rem;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.06);
        border: 1px solid var(--lightgray);
        transition: all 0.3s ease;

        &:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.08);
            border-color: var(--secondary);
        }
    }
}

// 标签卡片
.tags {
    a {
        display: inline-block;
        padding: 0.4rem 0.8rem;
        margin: 0.3rem 0.2rem;
        border-radius: 20px;
        background-color: var(--lightgray);
        transition: all 0.3s ease;
        font-size: 0.9rem;
        border: 1px solid transparent;

        &:hover {
            background-color: var(--secondary);
            color: var(--light);
            transform: scale(1.05);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
    }
}

// 图表卡片（如果有）
#graph-container,
.graph {
    background-color: var(--light);
    border-radius: 12px;
    padding: 1rem;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
    border: 1px solid var(--lightgray);
}

// 面包屑优化
.breadcrumb-container {
    padding: 0.8rem 1rem;
    background-color: var(--light);
    border-radius: 8px;
    margin-bottom: 1.5rem;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.04);
    border: 1px solid var(--lightgray);
}

// ==========================================
// 目录(TOC)动态高亮效果
// ==========================================

.toc-content a {
    transition: all 0.3s ease;
    opacity: 0.6;
    position: relative;
    padding-left: 1rem;

    &::before {
        content: '';
        position: absolute;
        left: 0;
        top: 50%;
        transform: translateY(-50%);
        width: 0;
        height: 2px;
        background-color: var(--secondary);
        transition: width 0.3s ease;
    }

    // 当前正在阅读的章节
    &.active {
        opacity: 1;
        font-weight: 600;
        color: var(--secondary);

        &::before {
            width: 0.5rem;
        }
    }

    // 悬停效果
    &:hover {
        opacity: 1;
        transform: translateX(4px);

        &::before {
            width: 0.5rem;
        }
    }
}

// 优化TOC整体样式
.toc {
    position: sticky;
    top: 1rem;
    max-height: calc(100vh - 2rem);
    overflow-y: auto;
    order: -1; // 让TOC排在最前面
    padding-right: 0.5rem; // 给滚动条留点空间（虽然隐藏了）

    // 隐藏滚动条但保留功能
    scrollbar-width: none; // Firefox
    -ms-overflow-style: none; // IE/Edge

    &::-webkit-scrollbar {
        display: none; // Chrome/Safari
    }
}

// 调整TOC卡片内边距，使其更紧凑
.right .desktop-only:has(.toc-content) {
    padding: 0.8rem;
}


// 限制关系图谱高度
#graph-container,
.graph {
    background-color: var(--light);
    border-radius: 12px;
    padding: 1rem;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
    border: 1px solid var(--lightgray);
    max-height: 400px; // 限制最大高度
    overflow: hidden;
    order: 1; // Graph 排在后面
}

// 右侧栏优化
.right {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

// ==========================================
// 页面切换过渡动画
// ==========================================

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes fadeIn {
    from {
        opacity: 0;
    }

    to {
        opacity: 1;
    }
}

// 应用动画到主要内容区域
.page {
    animation: fadeInUp 0.6s cubic-bezier(0.2, 0.8, 0.2, 1);
}

// 侧边栏延迟动画
.left,
.right {
    animation: fadeIn 0.8s ease-out;
}

// 启用视图过渡 API (Chrome/Edge 111+)
::view-transition-old(root),
::view-transition-new(root) {
    animation-duration: 0.3s;
}